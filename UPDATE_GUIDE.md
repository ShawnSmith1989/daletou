# 大乐透数据更新功能使用指南

## 概述

本项目已添加了大乐透数据自动更新功能，可以从中国体彩网获取最新的开奖数据，并自动补充到现有数据中。

## 功能特点

1. **自动获取最新数据** - 从中国体彩网API获取最新开奖数据
2. **智能合并数据** - 只添加缺失的数据，避免重复
3. **实时进度显示** - 显示数据获取和合并进度
4. **错误处理** - 提供友好的错误提示和解决方案

## 使用方法

### 方法一：在网页中直接更新

1. 打开 `index.html` 或 `chart.html`
2. 点击页面上的 **"更新数据"** 按钮（橙色按钮）
3. 在弹出的对话框中点击 **"确认更新"**
4. 等待数据获取完成，系统会显示更新结果

### 方法二：通过命令行更新

1. 打开命令行/终端
2. 进入项目目录：`cd d:\daletgou\dlt4`
3. 执行更新命令：`node update_data.js`
4. 等待脚本执行完成

## 技术实现

### 数据源
- API地址：`https://webapi.sporttery.cn/gateway/lottery/getHistoryPageListV1.qry`
- 参数：`gameNo=85&provinceId=0&pageSize=30&isVerify=1&pageNo=1`

### 文件结构
- `update_data.js` - Node.js更新脚本，用于后端更新
- `index.html` - 主页面，包含数据表格和分析功能
- `chart.html` - 图表页面，包含走势图和统计功能
- `script.js` - 主页面JavaScript逻辑
- `chart.js` - 图表页面JavaScript逻辑

### 数据流程
1. 从API获取最新数据
2. 解析API响应，提取开奖号码
3. 与现有数据比较，过滤重复记录
4. 合并新数据到现有数据集
5. 更新页面显示和统计数据

## 注意事项

1. **网络要求** - 需要能够访问中国体彩网的API
2. **数据格式** - API响应格式可能发生变化，需要相应调整解析逻辑
3. **更新频率** - 大乐透每周开奖三次（周一、三、六），建议在这些日期后更新数据
4. **备份** - 重要数据建议定期备份`data.js`和`dlt_all.txt`文件

## 故障排除

### 常见问题

1. **"API返回数据格式不正确"**
   - 检查网络连接
   - 确认API地址是否可访问
   - 可能需要更新API解析逻辑

2. **"更新后数据未显示"**
   - 刷新浏览器页面
   - 检查浏览器控制台是否有错误信息
   - 确认`data.js`文件是否已更新

3. **更新按钮无响应**
   - 检查浏览器是否支持JavaScript
   - 查看浏览器控制台是否有错误信息

## 更新历史

- 2025-11-09：初始版本实现，支持从中国体彩网API获取最新开奖数据
- 支持自动合并数据，避免重复
- 添加进度显示和错误处理机制